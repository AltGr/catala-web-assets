<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>shared_ast (catala.shared_ast)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="index.html">Up</a> â€“ <a href="index.html">catala</a> &#x00BB; shared_ast</nav><header class="odoc-preamble"><h1 id="default-calculus"><a href="#default-calculus" class="anchor"></a>Default calculus</h1><p>This module contains a generic AST structure, various type definitions and helpers that are reused in various passes of the compiler.</p></header><nav class="odoc-toc"><ul><li><a href="#the-shared_ast.definitions-module">The <code>Shared_ast.Definitions</code> module</a></li><li><a href="#helper-library">Helper library</a></li></ul></nav><div class="odoc-content"><h2 id="the-shared_ast.definitions-module"><a href="#the-shared_ast.definitions-module" class="anchor"></a>The <code>Shared_ast.Definitions</code> module</h2><p>The main module <a href="Shared_ast/index.html"><code>Shared_ast</code></a> is exposed at top-level of the library (so that <code>open Shared_ast</code> gives access to the structures). It defines literals, operators, and in particular the type <a href="Shared_ast/index.html#type-naked_gexpr"><code>Shared_ast.naked_gexpr</code></a>.</p><p>The <a href="Shared_ast/index.html#type-naked_gexpr"><code>Shared_ast.naked_gexpr</code></a> type regroups all the cases for the <a href="../dcalc.html">Dcalc</a> and <a href="../lcalc.html">Lcalc</a> ASTs, with unconstrained annotations (used for positions, types, etc.). A GADT is used to eliminate irrelevant cases, so that e.g. <code>(dcalc, _) naked_gexpr</code> doesn't have the <code>ERaise</code> and <code>ECatch</code> cases, while <code>(lcalc, _) naked_gexpr</code> doesn't have <code>EDefault</code>.</p><p>For example, Lcalc expressions are then defined as <code>type 'm naked_expr = (Shared_ast.lcalc, 'm) Shared_ast.naked_gexpr</code>.</p><p>This makes it possible to write a single function that works on the different ASTs, by having it take a <code>('a, _) naked_gexpr</code> as input, while retaining a much stricter policy than polymorphic variants.</p><p>The module additionally defines the encompassing <code>scope</code> and <code>program</code> structures that are also shared between different compiler passes.</p><h2 id="helper-library"><a href="#helper-library" class="anchor"></a>Helper library</h2><p>The <a href="Shared_ast/Var/index.html"><code>Shared_ast.Var</code></a> defines <code>'e Var.Set.t</code> and <code>('e, _) Var.Map.t</code> types that are useful to handle variables for the different <code>'e</code> expression types without re-instanciating <code>Set.Make</code> and <code>Map.Make</code> each time.</p><p><a href="Shared_ast/Expr/index.html"><code>Shared_ast.Expr</code></a> contains various helpers to build well-formed expressions, and for traversal.</p><p>The following modules are dedicated to handling the program structure around expressions. Note that these don't make sense for the early compiler passes (up to <code>Scopelang</code>).</p><ul class="modules"><li><a href="Shared_ast/Scope/index.html"><code>Shared_ast.Scope</code></a> <span class="synopsis">Functions handling the code item structures of <code>shared_ast</code>, in particular the scopes</span></li><li><a href="Shared_ast/Program/index.html"><code>Shared_ast.Program</code></a> </li></ul></div></body></html>